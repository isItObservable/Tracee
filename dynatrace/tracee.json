{"version":16,"variables":[],"tiles":{"0":{"type":"markdown","title":"","content":"**Tracee Agents**"},"1":{"type":"data","title":"Number of Tetragon Agents","query":"fetch dt.entity.cloud_application_instance\n| filter contains(entity.name,\"tracee-\") and not contains(entity.name,\"operator\")\n| summarize count()","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"categoryAxisLabel":"entity.name,id","valueAxisLabel":"","tooltipVariant":"single"},"truncationMode":"middle"},"singleValue":{"showLabel":false,"label":"count()","prefixIcon":"","recordField":"count()","autoscale":true,"alignment":"center","colorThresholdTarget":"value","trend":{"trendType":"auto","isVisible":false}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{},"displayedFields":[]},"histogram":{"dataMappings":[{"valueAxis":"count()","rangeAxis":""}],"variant":"single","displayedFields":[]},"autoSelectVisualization":false},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"2":{"type":"data","title":"Cpu health of the ae","query":"timeseries cpu_usages = avg(dt.kubernetes.container.cpu_usage),by:{  k8s.pod.name}\n| fieldsAdd cpu=arrayAvg(cpu_usages)\n| filter contains(k8s.pod.name,\"tracee\") and not contains(k8s.pod.name,\"operator\")\n| fieldsRemove cpu_usages","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"honeycomb","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxisLabel":"k8s.pod.name","valueAxisLabel":"cpu","tooltipVariant":"single","categoryAxis":["k8s.pod.name"],"valueAxis":["cpu"]},"hiddenLegendFields":["k8s.workload","k8s.pod"],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["interval"],"leftAxisDimensions":["k8s.pod.name"]},"valueRepresentation":"absolute","xAxisLabel":"timeframe","xAxisIsLabelVisible":false,"leftYAxisSettings":{}},"singleValue":{"showLabel":true,"label":"k8s.workload.name","prefixIcon":"","recordField":"k8s.workload.name","autoscale":true,"alignment":"center","colorThresholdTarget":"value","trend":{"trendType":"auto","isVisible":false}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"bottom"},"colorMode":"color-palette","colorPalette":"red","dataMappings":{"value":"cpu"},"displayedFields":["k8s.pod.name"]},"histogram":{"dataMappings":[{"valueAxis":"interval","rangeAxis":""},{"valueAxis":"cpu","rangeAxis":""}],"variant":"single","displayedFields":["k8s.pod.name"]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"3":{"type":"data","title":"memory health","query":"timeseries cpu_usages = avg(dt.kubernetes.container.memory_working_set), by:{  k8s.pod.name}\n| fieldsAdd memory=arrayAvg(cpu_usages)\n| filter contains(k8s.pod.name,\"tracee\") and not contains(k8s.pod.name,\"operator\")\n| fieldsRemove cpu_usages","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"honeycomb","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxisLabel":"k8s.pod.name","valueAxisLabel":"memory","tooltipVariant":"single","categoryAxis":["k8s.pod.name"],"valueAxis":["memory"]},"hiddenLegendFields":["k8s.workload","k8s.pod"],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["interval"],"leftAxisDimensions":["k8s.pod.name"]},"valueRepresentation":"absolute","xAxisLabel":"timeframe","xAxisIsLabelVisible":false,"leftYAxisSettings":{}},"singleValue":{"showLabel":true,"label":"k8s.workload.name","prefixIcon":"","recordField":"k8s.workload.name","autoscale":true,"alignment":"center","colorThresholdTarget":"value","trend":{"trendType":"auto","isVisible":false}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"bottom"},"colorMode":"color-palette","colorPalette":"red","dataMappings":{"value":"memory"},"displayedFields":["k8s.pod.name"]},"histogram":{"dataMappings":[{"valueAxis":"interval","rangeAxis":""},{"valueAxis":"memory","rangeAxis":""}],"variant":"single","displayedFields":["k8s.pod.name"]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"4":{"type":"data","title":"ebpf network event /s per policy name","query":"timeseries avg(tracee_ebpf_network_capture_events_total, rate: 1s)\n| limit 20","queryConfig":{"version":"11.5.0","subQueries":[{"id":"A","isEnabled":true,"limit":20,"filter":"","datatype":"metrics","metric":{"key":"tracee_ebpf_network_capture_events_total","aggregation":"avg"},"by":[],"rate":"1s"}]},"subType":"dql-builder-metrics","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"absolute"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxisLabel":"policyname","valueAxisLabel":"interval","tooltipVariant":"single"},"hiddenLegendFields":[],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(tracee_ebpf_network_capture_events_total, rate:1s)"],"leftAxisDimensions":[]},"valueRepresentation":"absolute","xAxisLabel":"timeframe","xAxisIsLabelVisible":false,"leftYAxisSettings":{}},"singleValue":{"showLabel":true,"label":"rule_name","prefixIcon":"","recordField":"rule_name","autoscale":true,"alignment":"center","colorThresholdTarget":"value","trend":{"trendType":"auto","isVisible":true}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"blue","dataMappings":{},"displayedFields":[]},"histogram":{"dataMappings":[{"valueAxis":"interval","rangeAxis":""}],"variant":"single","displayedFields":[]},"autoSelectVisualization":false},"davis":{},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"5":{"type":"markdown","title":"","content":"**Tracee Events**"},"8":{"type":"data","title":"Event Per s","query":"timeseries avg(tracee_ebpf_events_total, rate: 1s)\n| limit 20","queryConfig":{"version":"11.5.0","subQueries":[{"id":"A","isEnabled":true,"limit":20,"datatype":"metrics","metric":{"key":"tracee_ebpf_events_total","aggregation":"avg"},"by":[],"rate":"1s"}]},"subType":"dql-builder-metrics","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"vertical","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxisLabel":"operation","valueAxisLabel":"interval","tooltipVariant":"single"},"colorPalette":"categorical","truncationMode":"middle","hiddenLegendFields":[],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(tracee_ebpf_events_total, rate:1s)"],"leftAxisDimensions":[]},"valueRepresentation":"absolute","xAxisLabel":"timeframe","xAxisIsLabelVisible":false,"leftYAxisSettings":{}},"singleValue":{"showLabel":true,"label":"type","prefixIcon":"","recordField":"type","autoscale":true,"alignment":"center","colorThresholdTarget":"value","trend":{"trendType":"auto","isVisible":true}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"blue","dataMappings":{},"displayedFields":[]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"interval","rangeAxis":""}],"variant":"single","displayedFields":[]}},"davis":{},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"10":{"type":"data","title":"Cpu Usage per agents","query":"timeseries avg(dt.kubernetes.container.cpu_usage), by: { k8s.pod.name }, filter: { matchesValue(k8s.daemonset.name, \"tracee\") }\n| limit 20","queryConfig":{"version":"11.5.0","subQueries":[{"id":"A","isEnabled":true,"limit":20,"filter":"k8s.daemonset.name = tracee ","datatype":"metrics","metric":{"key":"dt.kubernetes.container.cpu_usage","aggregation":"avg"},"by":["k8s.pod.name"]}]},"subType":"dql-builder-metrics","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"smooth","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"vertical","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxisLabel":"k8s.pod.name","valueAxisLabel":"interval","tooltipVariant":"single","categoryAxis":["k8s.pod.name"],"valueAxis":["interval"]},"colorPalette":"categorical","truncationMode":"middle","hiddenLegendFields":[],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(dt.kubernetes.container.cpu_usage)"],"leftAxisDimensions":["k8s.pod.name"]},"valueRepresentation":"absolute","xAxisLabel":"timeframe","xAxisIsLabelVisible":false,"leftYAxisSettings":{"isLabelVisible":true,"label":"Kubernetes: Container - CPU usage"}},"singleValue":{"showLabel":true,"label":"op","prefixIcon":"","recordField":"op","autoscale":true,"alignment":"center","colorThresholdTarget":"value","trend":{"trendType":"auto","isVisible":true}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"k8s.pod.name"},"displayedFields":["k8s.pod.name"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"interval","rangeAxis":""}],"variant":"single","displayedFields":["k8s.pod.name"]},"autoSelectVisualization":false},"davis":{},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"13":{"type":"markdown","title":"","content":"**Tracee health**"},"14":{"type":"data","title":"Cpu Throttling","query":"timeseries avg(dt.kubernetes.container.cpu_usage, rate: 1s), by: { k8s.pod.name }, filter: { matchesValue(k8s.deployment.name, \"tracee-operator\") }","queryConfig":{"version":"11.5.0","subQueries":[{"id":"A","isEnabled":true,"filter":"k8s.deployment.name = tracee-operator ","datatype":"metrics","metric":{"key":"dt.kubernetes.container.cpu_usage","aggregation":"avg"},"by":["k8s.pod.name"],"rate":"1s"}]},"subType":"dql-builder-metrics","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"vertical","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["k8s.pod.name"],"valueAxis":["interval"],"categoryAxisLabel":"k8s.pod.name","valueAxisLabel":"interval","tooltipVariant":"single"},"colorPalette":"categorical","hiddenLegendFields":[],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(dt.kubernetes.container.cpu_usage, rate:1s)"],"leftAxisDimensions":["k8s.pod.name"]},"valueRepresentation":"absolute","truncationMode":"middle","xAxisLabel":"timeframe","xAxisIsLabelVisible":false,"leftYAxisSettings":{"isLabelVisible":true,"label":"Kubernetes: Container - CPU throttled"}},"singleValue":{"showLabel":true,"label":"k8s.pod.name","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value","trend":{"trendType":"auto","isVisible":true},"recordField":"k8s.pod.name"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"k8s.pod.name"},"displayedFields":["k8s.pod.name"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"interval","rangeAxis":""}],"variant":"single","displayedFields":["k8s.pod.name"]}},"davis":{},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"16":{"type":"data","title":"Memory  usage ","query":"timeseries avg(dt.kubernetes.container.memory_working_set), by: { k8s.pod.name }, filter: { matchesValue(k8s.daemonset.name, \"tracee\") }\n| limit 20","queryConfig":{"version":"11.5.0","subQueries":[{"id":"A","isEnabled":true,"limit":20,"filter":"k8s.daemonset.name = tracee ","datatype":"metrics","metric":{"key":"dt.kubernetes.container.memory_working_set","aggregation":"avg"},"by":["k8s.pod.name"]}]},"subType":"dql-builder-metrics","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"smooth","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"vertical","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["k8s.pod.name"],"valueAxis":["interval"],"categoryAxisLabel":"k8s.pod.name","valueAxisLabel":"interval","tooltipVariant":"single"},"colorPalette":"categorical","hiddenLegendFields":[],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(dt.kubernetes.container.memory_working_set)"],"leftAxisDimensions":["k8s.pod.name"]},"valueRepresentation":"absolute","truncationMode":"middle","xAxisLabel":"timeframe","xAxisIsLabelVisible":false,"leftYAxisSettings":{"isLabelVisible":true,"label":"Kubernetes: Container - working set memory"}},"singleValue":{"showLabel":true,"label":"k8s.pod.name","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value","trend":{"trendType":"auto","isVisible":true},"recordField":"k8s.pod.name"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"k8s.pod.name"},"displayedFields":["k8s.pod.name"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"interval","rangeAxis":""}],"variant":"single","displayedFields":["k8s.pod.name"]},"autoSelectVisualization":false},"davis":{},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"19":{"type":"data","title":"Event write lost ","query":"timeseries avg(tracee_ebpf_write_lostevents_total, rate: 1s)","queryConfig":{"version":"11.5.0","subQueries":[{"id":"A","isEnabled":true,"datatype":"metrics","metric":{"key":"tracee_ebpf_write_lostevents_total","aggregation":"avg"},"rate":"1s"}]},"subType":"dql-builder-metrics","visualization":"areaChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"vertical","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color"},"colorPalette":"categorical","hiddenLegendFields":[],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(tracee_ebpf_write_lostevents_total, rate:1s)"],"leftAxisDimensions":[]},"valueRepresentation":"absolute","xAxisLabel":"timeframe","xAxisIsLabelVisible":false,"leftYAxisSettings":{}},"singleValue":{"showLabel":true,"prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value","trend":{"trendType":"auto","isVisible":true}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{},"displayedFields":[]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"interval","rangeAxis":""}],"variant":"single","displayedFields":[]}},"davis":{},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"23":{"type":"data","title":"","query":"fetch logs\n| filter k8s.namespace.name==\"tracee\"\n| parse log, \"JSON:json_log\"\n| fieldsAdd processname=json_log[processName], hostname=json_log[hostName],eventname=json_log[eventName],policicies=json_log[matchedPolicies] , k8s_json=json_log[kubernetes], contain_json=json_log[container], syscall=json_log[syscall]\n| fieldsAdd containername=contain_json[name], pod_name=k8s_json[podName], pod_namespace=k8s_json[podNamespace], policy_0=policicies[0]\n| fieldsRemove contain_json, k8s_json, policicies\n| summarize count() , by:{eventname}","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"pieChart","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["eventname"],"valueAxis":["count()"],"categoryAxisLabel":"eventname","valueAxisLabel":"count()","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle"},"singleValue":{"showLabel":true,"label":"namespace","prefixIcon":"","recordField":"namespace","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":false},"colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":["eventname"],"dataMappings":{"value":"count()"},"colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"count()","rangeAxis":""}],"variant":"single","displayedFields":["eventname"]},"autoSelectVisualization":false},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"24":{"type":"data","title":"Number of events per minute raised","query":"fetch logs\n| filter k8s.namespace.name==\"tracee\"\n| parse log, \"JSON:json_log\"\n| fieldsAdd processname=json_log[processName], hostname=json_log[hostName],eventname=json_log[eventName],policicies=json_log[matchedPolicies] , k8s_json=json_log[kubernetes], contain_json=json_log[container], syscall=json_log[syscall]\n| fieldsAdd containername=contain_json[name], pod_name=k8s_json[podName], pod_namespace=k8s_json[podNamespace], policy_0=policicies[0]\n| fieldsRemove contain_json, k8s_json, policicies\n| summarize count(), by:{bin(timestamp, 60s),pod_namespace,eventname}","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"barChart","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"smooth","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["pod_namespace","eventname"],"valueAxis":["count()"],"categoryAxisLabel":"pod_namespace,eventname","valueAxisLabel":"count()","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","fieldMapping":{"timestamp":"bin(timestamp, 60s)","leftAxisValues":["count()"],"leftAxisDimensions":["pod_namespace"]},"hiddenLegendFields":[],"xAxisLabel":"bin(timestamp, 60s)","xAxisIsLabelVisible":false,"leftYAxisSettings":{}},"singleValue":{"showLabel":true,"label":"namespace","prefixIcon":"","recordField":"namespace","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":false},"colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":["pod_namespace","eventname"],"dataMappings":{"value":"count()"},"colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"count()","rangeAxis":""}],"variant":"single","displayedFields":["pod_namespace","eventname"]},"autoSelectVisualization":false},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"25":{"type":"data","title":"Type of events raised","query":"fetch logs\n| filter k8s.namespace.name==\"tracee\"\n| parse log, \"JSON:json_log\"\n| fieldsAdd processname=json_log[processName], hostname=json_log[hostName],eventname=json_log[eventName],policicies=json_log[matchedPolicies] , k8s_json=json_log[kubernetes], contain_json=json_log[container], syscall=json_log[syscall]\n| fieldsAdd containername=contain_json[name], pod_name=k8s_json[podName], pod_namespace=k8s_json[podNamespace], policy_0=policicies[0]\n| fieldsRemove contain_json, k8s_json, policicies\n| summarize count(), by:{bin(timestamp, 60s),eventname}","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"smooth","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["eventname"],"categoryAxisLabel":"eventname","valueAxis":["count()"],"valueAxisLabel":"count()","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","fieldMapping":{"timestamp":"bin(timestamp, 60s)","leftAxisValues":["count()"],"leftAxisDimensions":["eventname"]},"xAxisLabel":"bin(timestamp, 60s)","xAxisIsLabelVisible":false,"hiddenLegendFields":[],"leftYAxisSettings":{}},"singleValue":{"showLabel":true,"label":"operation","prefixIcon":"","recordField":"operation","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":false},"colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":["eventname"],"dataMappings":{"value":"count()"},"colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"count()","rangeAxis":""}],"variant":"single","displayedFields":["eventname"]},"autoSelectVisualization":false},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"26":{"type":"markdown","title":"","content":"## Tracee Alerts ##"},"27":{"type":"data","title":"Number Of policies per Namespace","query":"fetch logs\n| filter k8s.namespace.name==\"tracee\"\n| parse log, \"JSON:json_log\"\n| fieldsAdd processname=json_log[processName], hostname=json_log[hostName],eventname=json_log[eventName],policicies=json_log[matchedPolicies] , k8s_json=json_log[kubernetes], contain_json=json_log[container], syscall=json_log[syscall]\n| fieldsAdd containername=contain_json[name], pod_name=k8s_json[podName], pod_namespace=k8s_json[podNamespace], policy_0=policicies[0]\n| fieldsRemove contain_json, k8s_json, policicies\n| summarize count(), by:{bin(timestamp, 60s),pod_namespace,policy_0}","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["pod_namespace","policy_0"],"categoryAxisLabel":"pod_namespace,policy_0","valueAxis":["count()"],"valueAxisLabel":"count()","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","hiddenLegendFields":[],"fieldMapping":{"timestamp":"bin(timestamp, 60s)","leftAxisValues":["count()"],"leftAxisDimensions":["pod_namespace"]},"xAxisLabel":"bin(timestamp, 60s)","xAxisIsLabelVisible":false,"leftYAxisSettings":{}},"singleValue":{"showLabel":true,"label":"bin(timestamp, 30s)","prefixIcon":"","recordField":"bin(timestamp, 30s)","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":false},"colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":["pod_namespace","policy_0"],"dataMappings":{"value":"count()"},"colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"count()","rangeAxis":""}],"variant":"single","displayedFields":["pod_namespace","policy_0"]},"autoSelectVisualization":false},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"28":{"type":"data","title":"Memory  usage ","query":"timeseries avg(dt.kubernetes.container.memory_working_set), by: { k8s.pod.name }, filter: { matchesValue(k8s.deployment.name, \"tracee-operator\") }\n| limit 20","queryConfig":{"version":"11.5.0","subQueries":[{"id":"A","isEnabled":true,"limit":20,"filter":"k8s.deployment.name = tracee-operator ","datatype":"metrics","metric":{"key":"dt.kubernetes.container.memory_working_set","aggregation":"avg"},"by":["k8s.pod.name"]}]},"subType":"dql-builder-metrics","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"smooth","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"vertical","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["k8s.pod.name"],"valueAxis":["interval"],"categoryAxisLabel":"k8s.pod.name","valueAxisLabel":"interval","tooltipVariant":"single"},"colorPalette":"categorical","hiddenLegendFields":[],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(dt.kubernetes.container.memory_working_set)"],"leftAxisDimensions":["k8s.pod.name"]},"valueRepresentation":"absolute","truncationMode":"middle","xAxisLabel":"timeframe","xAxisIsLabelVisible":false,"leftYAxisSettings":{"isLabelVisible":true,"label":"Kubernetes: Container - working set memory"}},"singleValue":{"showLabel":true,"label":"k8s.pod.name","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value","trend":{"trendType":"auto","isVisible":true},"recordField":"k8s.pod.name"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{"value":"k8s.pod.name"},"displayedFields":["k8s.pod.name"]},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"interval","rangeAxis":""}],"variant":"single","displayedFields":["k8s.pod.name"]},"autoSelectVisualization":false},"davis":{},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"29":{"type":"data","title":"tracee errors /s","query":"timeseries avg(tracee_ebpf_errors_total, rate: 1s)","queryConfig":{"version":"11.5.0","subQueries":[{"id":"A","isEnabled":true,"datatype":"metrics","metric":{"key":"tracee_ebpf_errors_total","aggregation":"avg"},"rate":"1s"}]},"subType":"dql-builder-metrics","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","xAxisLabel":"timeframe","xAxisIsLabelVisible":false,"hiddenLegendFields":[],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(tracee_ebpf_errors_total, rate:1s)"],"leftAxisDimensions":[]},"leftYAxisSettings":{}},"singleValue":{"showLabel":true,"prefixIcon":"","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":[],"dataMappings":{},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"interval","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":[]}},"davis":{},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"30":{"type":"data","title":"","query":"timeseries avg(tracee_ebpf_events_filtered, rate: 1s)","queryConfig":{"version":"11.5.0","subQueries":[{"id":"A","isEnabled":true,"filter":"","datatype":"metrics","metric":{"key":"tracee_ebpf_events_filtered","aggregation":"avg"},"rate":"1s"}]},"subType":"dql-builder-metrics","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","xAxisLabel":"timeframe","xAxisIsLabelVisible":false,"hiddenLegendFields":[],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(tracee_ebpf_events_filtered, rate:1s)"],"leftAxisDimensions":[]},"leftYAxisSettings":{}},"singleValue":{"showLabel":true,"prefixIcon":"","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":[],"dataMappings":{},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"interval","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":[]}},"davis":{},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}},"layouts":{"0":{"x":0,"y":0,"w":24,"h":1},"1":{"x":0,"y":1,"w":3,"h":6},"2":{"x":3,"y":1,"w":4,"h":6},"3":{"x":7,"y":1,"w":4,"h":6},"4":{"x":0,"y":15,"w":6,"h":8},"5":{"x":0,"y":7,"w":24,"h":1},"8":{"x":6,"y":15,"w":7,"h":8},"10":{"x":0,"y":30,"w":10,"h":7},"13":{"x":0,"y":29,"w":24,"h":1},"14":{"x":0,"y":37,"w":10,"h":6},"16":{"x":10,"y":30,"w":10,"h":7},"19":{"x":16,"y":8,"w":8,"h":6},"23":{"x":11,"y":1,"w":8,"h":6},"24":{"x":0,"y":8,"w":11,"h":6},"25":{"x":11,"y":8,"w":5,"h":6},"26":{"x":0,"y":14,"w":16,"h":1},"27":{"x":13,"y":15,"w":7,"h":8},"28":{"x":10,"y":37,"w":10,"h":7},"29":{"x":0,"y":23,"w":8,"h":6},"30":{"x":8,"y":23,"w":8,"h":6}},"importedWithCode":false,"settings":{}}